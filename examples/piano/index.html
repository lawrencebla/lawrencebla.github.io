<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
  <script>  
    var opern = ['+3', '+2', '+1', '7', '6', '5', '6', '7', '+3', '+2', '+1', '7', '6', '5', '6', '7', '+3', '+2', '+1', '7', '6', '5', '6', '7', '+1', '7', '6', '5', '4', '3', '4', '2',

    '-1', '7', '+1', '1', '-7', '5', '2', '3', '1', '+1', '7', '6', '7', '+3', '+5', '+6', '+4', '+3', '+2', '+4', '+4', '+3', '+1', '7', '6', '5', '4', '3', '2', '4', '3', '2', '+1', '7', '+1', '1', '-7', '5', '2', '3', '1', '+1', '7', '6', '7', '+3', '+5', '+6', '+4', '+3', '+2', '+4', '+3', '+2', '+1', '7', '6', '5', '4', '3', '2', '4', '3', '5',

    '+5', '+3', '+4', '+5', '+3', '+4', '+5', '5', '6', '7', '+1', '+2', '+3', '+4', '+3', '+1', '+2', '+3', '3', '4', '5', '6', '5', '4', '5', '3', '4', '5', '4', '6', '5', '4', '3', '2', '3', '2', '1', '2', '3', '4', '5', '6', '4', '6', '5', '6', '7', '+1', '+2', '+3', '+4', '+5', '+3', '+1', '+2', '+3', '+2', '+1', '+2', '7', '+1', '+2', '+3', '+2', '+1', '7', '+1', '6', '7', '+1', '1', '2', '3', '4', '3', '2', '3', '+1', '7', '+1', '6', '+1', '7', '6', '5', '4', '5', '4', '3', '4', '5', '6', '7', '+1', '6', '+1', '7', '+1', '7', '6', '7', '+1', '+2', '+1', '7', '+1', '6', '7',
    ];
    var i = 0;
    function isPC() {
        var userAgentInfo = navigator.userAgent;
        var Agents = ["Android", "iPhone",
                    "SymbianOS", "Windows Phone",
                    "iPad", "iPod"];
        var flag = true;
        for (var v = 0; v < Agents.length; v++) {
            if (userAgentInfo.indexOf(Agents[v]) > 0) {
                flag = false;
                break;
            }
        }
        return flag;
    }
    function play() {
      if( i >= opern.length ) {
        return;
      }
      audioCtx.play(coverNumToHz(opern[i++]));
    }
    function reset() {
      i = 0;
    }
  </script>
</head>
  <div style='width: 150px; height: 200px;border: 1px solid';>
    <div style='float: left; width: 75px; height: 100%; background-color: #000;' onmouseenter='isPC() && play()' ontouchstart ='play()'></div>
    <div style='float: right; width: 75px; height: 100%;' onmouseenter='isPC() && play()' ontouchstart ='play()'></div>
  </div>
  <button onClick='reset()'>reset</button>
<body>
  <script>
    const ONE_LINED_NOTES = [261.63, 293.66, 329.63, 349.23, 392.00, 440.00, 493.88];
    const DIATONIC_SCALE = ['subsubcontra', 'subcontra', 'contra', 'great', 'small', 'one-lined', 'two-lined', 'three-lined', 'four-lined', 'five-lined', 'six-lined'];
    let DiatonicNotes = {
      [DIATONIC_SCALE[0]]: ONE_LINED_NOTES.map(note => note / 32),
      [DIATONIC_SCALE[1]]: ONE_LINED_NOTES.map(note => note / 16),
      [DIATONIC_SCALE[2]]: ONE_LINED_NOTES.map(note => note / 8),
      [DIATONIC_SCALE[3]]: ONE_LINED_NOTES.map(note => note / 4),
      [DIATONIC_SCALE[4]]: ONE_LINED_NOTES.map(note => note / 2),
      [DIATONIC_SCALE[5]]: ONE_LINED_NOTES,
      [DIATONIC_SCALE[6]]: ONE_LINED_NOTES.map(note => note * 2),
      [DIATONIC_SCALE[7]]: ONE_LINED_NOTES.map(note => note * 4),
      [DIATONIC_SCALE[8]]: ONE_LINED_NOTES.map(note => note * 8),
      [DIATONIC_SCALE[9]]: ONE_LINED_NOTES.map(note => note * 16),
      [DIATONIC_SCALE[10]]: ONE_LINED_NOTES.map(note => note * 32),
    };

    let audioCtx = new AudioCtx();

    let scaleIdx = 0,
    noteIdx = 0,
    asc = true;


    function coverNumToHz(num) {
      num = num + '';
      let baseScaleIdx = 5;
      if( num.indexOf('-') > -1 ) {
        baseScaleIdx = baseScaleIdx - (num.length - 1)
      } else if(num.indexOf('+') > -1) {        
        baseScaleIdx = baseScaleIdx + (num.length - 1)
      }

      return DiatonicNotes[DIATONIC_SCALE[baseScaleIdx]][num.substr(-1) - 1]
    }
  
    function AudioCtx() {
      window.AudioContext = window.AudioContext || window.webkitAudioContext;
      if( window.AudioContext ) {
        this.audioCtx = new AudioContext();
      }
      return false;
    }
    AudioCtx.prototype.play = function(frequency) {
      let audioCtx = this.audioCtx;
      let oscillator = audioCtx.createOscillator();
      let gainNode = audioCtx.createGain();
      oscillator.connect(gainNode);
      gainNode.connect(audioCtx.destination);
      oscillator.type = 'sine';
  
      oscillator.frequency.value = frequency;
      gainNode.gain.setValueAtTime(0, audioCtx.currentTime);
      gainNode.gain.linearRampToValueAtTime(1, audioCtx.currentTime + 0.01);
      oscillator.start(audioCtx.currentTime);
      gainNode.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 1);
      oscillator.stop(audioCtx.currentTime + 1);
    }
  </script>
</body>
</html>
